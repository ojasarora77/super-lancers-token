import { CircuitsWasm, GeneratorIndex } from '@aztec/circuits.js';
import { pedersenHashWithHashIndex } from '@aztec/circuits.js/barretenberg';
import { PackedArguments } from '@aztec/types';
// docs:start:authwit_computeAuthWitMessageHash
/**
 * Compute an authentication witness message hash from a caller and a request
 * H(caller: AztecAddress, target: AztecAddress, selector: Field, args_hash: Field)
 * @param caller - The caller approved to make the call
 * @param request - The request to be made (function call)
 * @returns The message hash for the witness
 */
export const computeAuthWitMessageHash = async (caller, request) => {
    const wasm = await CircuitsWasm.get();
    return pedersenHashWithHashIndex(wasm, [
        caller.toField(),
        request.to.toField(),
        request.functionData.selector.toField(),
        (await PackedArguments.fromArgs(request.args, wasm)).hash,
    ].map(fr => fr.toBuffer()), GeneratorIndex.SIGNATURE_PAYLOAD);
};
// docs:end:authwit_computeAuthWitMessageHash
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXV0aHdpdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlscy9hdXRod2l0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBZ0IsWUFBWSxFQUFFLGNBQWMsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBQ2hGLE9BQU8sRUFBRSx5QkFBeUIsRUFBRSxNQUFNLGlDQUFpQyxDQUFDO0FBQzVFLE9BQU8sRUFBZ0IsZUFBZSxFQUFFLE1BQU0sY0FBYyxDQUFDO0FBRTdELCtDQUErQztBQUMvQzs7Ozs7O0dBTUc7QUFDSCxNQUFNLENBQUMsTUFBTSx5QkFBeUIsR0FBRyxLQUFLLEVBQUUsTUFBb0IsRUFBRSxPQUFxQixFQUFFLEVBQUU7SUFDN0YsTUFBTSxJQUFJLEdBQUcsTUFBTSxZQUFZLENBQUMsR0FBRyxFQUFFLENBQUM7SUFDdEMsT0FBTyx5QkFBeUIsQ0FDOUIsSUFBSSxFQUNKO1FBQ0UsTUFBTSxDQUFDLE9BQU8sRUFBRTtRQUNoQixPQUFPLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRTtRQUNwQixPQUFPLENBQUMsWUFBWSxDQUFDLFFBQVEsQ0FBQyxPQUFPLEVBQUU7UUFDdkMsQ0FBQyxNQUFNLGVBQWUsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUk7S0FDMUQsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsUUFBUSxFQUFFLENBQUMsRUFDMUIsY0FBYyxDQUFDLGlCQUFpQixDQUNqQyxDQUFDO0FBQ0osQ0FBQyxDQUFDO0FBQ0YsNkNBQTZDIn0=